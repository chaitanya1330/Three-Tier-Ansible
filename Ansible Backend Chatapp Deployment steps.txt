---
  #configuring the app server using ansible playbook
  - name: Appserver Configuring
    hosts: appservers
    remote_user: ubuntu
    become: yes
    gather_facts: yes
    tasks:
      - name: installing packages for chatapp
        apt: name=python3-pip state=present
      - name: Install virtualvenv python package
        pip: 
        name: vitualenv



## I have created virtual environment:

     - name: Set python virual env
       command:
         cmd: virtualenv /home/ubuntu/new-chatapp/ -p python3

## this gives error because we didnt gave executable path...in down we gave see|||| 
                                                                               ^^^^
     - name: Install requirements
       pip:
         requirements: /home/ubuntu/new-chatapp/requirements.txt
         virtualenv: /home/ubuntu/new-chatapp/venv
         virtualenv_python: python3



_----------------------------------------------------------------------------------------------------------------------------------------------
[Unit]
      Description=gunicorn daemon
      After=network.target
      [Service]
      User=root
      Group=www-data
      WorkingDirectory=/home/ubuntu/new-chatapp/fundoo
      ExecStart=/home/ubuntu/new-chatapp/venv/bin/gunicorn --workers 3 --bind 0.0.0.0:8000 fundoo.wsgi:application
     [Install]
     WantedBy=multi-user.target

                                                                             ^^^
# here we should copy our gunicorn service file in backend i.e the above file|||

- name: Copying gunicorn configurations to chatapp
  copy:
    src: /home/ubuntu/webserver/gunicorn
    dest :/etc/systemd/system/gunicorn.service


#  My playboook for backend:

---
 # Playbook For Deploying Python Application Using Django
 - name: Configuration of backend
   hosts: appservers
   remote_user: ubuntu
   become: yes
   gather_facts: yes
   tasks:
     - name: installing packages for chatapp
       apt: name=python3-pip state=present
       #- name: Clone Repo from github
       #  git:
         #  repo: https://github.com/peyyala7hills/chatapp.git
         # dest: new-chatapp
         #clone: yes
          #force: no
     - name: Install virtualenv using pip
       pip:
         name: virtualenv
         executable: /usr/local/bin/pip3
         state: present
     - name: Install specified python requirements for this Venv
       pip:
         requirements: /home/ubuntu/new-chatapp/requirements.txt
         virtualenv: /home/ubuntu/new-chatapp/venv
     - name: install package for chat app
       apt: name=default-libmysqlclient-dev state=present
     - name: install package for chat app
       apt: name=libssl-dev state=present
     - name: install mysqlclient
       pip:
         name: mysqlclient
	 virtualenv: /home/ubuntu/new-chatapp/venv
     - name: install package for chat app
       apt: name=python3-psycopg2 state=present
     - name: install psycopg2-binary
       pip:
         name: psycopg2-binary
         virtualenv: /home/ubuntu/new-chatapp/venv
     - name: Run migrate-command
       django_manage:
         command: migrate
         app_path: /home/ubuntu/new-chatapp/fundoo
         pythonpath: /home/ubuntu/new-chatapp/fundoo/fundoo
         virtualenv: /home/ubuntu/new-chatapp/venv
     - name: Copying gunicorn configurations to chatapp
       copy:
         src: /home/ubuntu/webserver/gunicorn
         dest: /etc/systemd/system/gunicorn.service
     - name: Start Gunicorn service
       systemd:
         name: gunicorn
         daemon_reload: yes
         state: started
         enabled: yes




